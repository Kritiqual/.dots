#!/usr/bin/env zsh

SAVEIFS=$IFS
IFS=$(echo -en "\n\b")

if [ -z "$1" ]; then
    # display usage if no parameters given
    echo "Usage: ex <path/file_name>.<zip|rar|bz2|gz|tar|tbz2|tgz|Z|7z|xz|ex|tar.bz2|tar.gz|tar.xz>"
    echo "       ex <path/file_name_1.ext> [path/file_name_2.ext] [path/file_name_3.ext]"
else
    for i in "$@"; do
        if [ -f "$i" ]; then
            case "${i%,}" in
            *.cbt | *.tar.bz2 | *.tar.gz | *.tar.xz | *.tbz2 | *.tgz | *.txz | *.tar)
                tar xvf "$i"
                ;;
            *.lzma)
                unlzma ./"$i"
                ;;
            *.bz2)
                bunzip2 ./"$i"
                ;;
            *.cbr | *.rar)
                unrar x -ad ./"$i"
                ;;
            *.gz)
                gunzip ./"$i"
                ;;
            *.cbz | *.epub | *.zip)
                unzip ./"$i"
                ;;
            *.z)
                uncompress ./"$i"
                ;;
            *.7z | *.arj | *.cab | *.cb7 | *.chm | *.deb | *.dmg | *.iso | *.lzh | *.msi | *.pkg | *.rpm | *.udf | *.wim | *.xar)
                7z x ./"$i"
                ;;
            *.xz)
                unxz ./"$i"
                ;;
            *.exe)
                cabextract ./"$i"
                ;;
            *.cpio)
                cpio -id <./"$i"
                ;;
            *.cba | *.ace)
                unace x ./"$i"
                ;;
            *)
                echo "extract: '$i' - unknown archive method"
                return 1
                ;;
            esac
        else
            echo "'$i' - file does not exist"
            return 1
        fi
    done
fi

IFS=$SAVEIFS
